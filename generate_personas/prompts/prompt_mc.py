# 1) system prompt
SYSTEM_PROMPT = """
당신은 의견 시뮬레이션을 위한 상세하고 편향 없는 페르소나 생성에 특화된 AI 어시스턴트입니다.
당신의 임무는 제공된 인구통계 정보를 기반으로 구체적이고 현실적이며 다양한 페르소나를 생성하고, 종합적인 JSON 템플릿을 작성하는 것입니다.
"""

# 2) JSON 스키마 정의
PERSONA_SCHEMA_JSON = {
    "title": "Generated Personas",
    "type": "array",
    "description": "생성된 복수의 페르소나 객체 리스트입니다. 각 객체는 하나의 페르소나를 나타냅니다.",
    "items": {
        "type": "object",
        "properties": {
            "uuid": {"type": "string"},
            "segment_key_input": {
                "type": "string",
                "description": "입력된 세그먼트 데이터의 고유 키"
            },
            "reasoning": {
                "type": "string",
                "description": "이 페르소나의 각 속성을 결정한 논리적 근거와 사고 과정을 설명합니다. (COT)"
            },
            "가구소득": {"type": "string"},
            "연령대": {"type": "string"},
            "가구원수": {"type": "string"},
            "성별": {"type": "string"},
            "지역": {"type": "string"},
            "교육수준": {"type": "string"},
            "직업": {"type": "string"},
            "건강관심도": {"type": "string"},
            "가구요리빈도": {"type": "string"},
            "주거형태": {"type": "string"},
            "건강투자정도": {"type": "string"},
            "운동여부": {"type": "string"},
            "sns사용빈도": {"type": "string"},
            "식료품구입빈도": {"type": "string"},
            "1회평균식료품구입금액": {"type": "integer"},
            "우유구입기준": {"type": "string", "description": "그릭요거트, 편의점커피라떼에만 해당"},
            "가공식품구입빈도": {"type": "string", "description": "스팸, 참치캔에만 해당"},
            "가공식품구입기준": {"type": "string", "description": "스팸, 참치캔에만 해당"}
        },
        "required": [
            "uuid",
            "segment_key_input",
            "reasoning",
            "가구소득", "연령대", "가구원수", "성별",
            "지역", "교육수준", "직업",  "건강관심도", "가구요리빈도", "주거형태",
            "건강투자정도", "운동여부", "sns사용빈도", "식료품구입빈도",
            "1회평균식료품구입금액"
        ]
    }
}

# 3) persona generation prompt

PERSONA_GEN_PROMPT_BASE = """
페르소나 생성 지침

아래 정보를 참고하여 '{keyword}' 제품군의 주구매자에 대한 구체적이고 현실적인 페르소나들을 생성하세요.
총 {num_segments}개의 세그먼트 데이터가 제공되며, **각 세그먼트**에 대해 **하나의 페르소나**를 생성해야 합니다.

### 컨텍스트 ###
{context}

### 지침 ###
1. 각 페르소나를 생성하기 위한 핵심 인구통계 정보와 메타데이터가 '### 세그먼트 데이터 ###' 섹션에 리스트 형태로 제공됩니다.
2. 최종 페르소나의 출력 형식은 '### JSON 스키마 ###'에 정의된 JSON 배열(리스트) 형태입니다. 제공된 각 세그먼트 데이터에 대해 하나의 페르소나 객체를 생성하여 이 배열에 담으세요.
3. 각 페르소나 객체는 해당 세그먼트의 'segment_key_input'을 반드시 포함해야 합니다.
4. 모든 메타 데이터 항목을 구체적으로 설명하고, 페르소나를 실제처럼 생동감 있게 작성하세요.
5. 메타 데이터의 각 항목에는 선택 가능한 값의 범위가 '### 값 범위 및 카테고리 ###'에 제공됩니다. 이 범위 내에서 가장 적합한 값을 선택하여 템플릿을 채우세요. **추가 정보나 다른 특성을 추가하지 마세요.** **모든 항목은 빈 값 없이 선택하거나 작성해야 합니다.**
6. **매우 중요**: 응답은 제공된 JSON 스키마를 따르는 단일 JSON 배열 객체만 작성하세요. 이 배열의 각 객체는 'reasoning'과 페르소나 속성들을 포함해야 합니다. 다른 설명이나 텍스트는 포함하지 마세요.

### COT 과정 지침 ###
각 세그먼트 데이터에 대한 페르소나를 생성하기 전, 다음 사고 과정을 따르세요. 이 과정은 각 페르소나 객체의 'reasoning' 필드에 3~4줄로 요약되어야 합니다.

1.  **핵심 인사이트 및 인구통계 파악**:
    * 현재 세그먼트의 '### PERSONA METADATA ###'와 위 '### 컨텍스트 ###'를 기반으로 이 세그먼트를 가장 잘 나타내는 특징들을 파악합니다.
    * 'meta_profile'에 명시된 '성별', '연령대', '가구소득', '가구원수' 등 핵심 인구통계를 페르소나의 기본 배경으로 설정하고, 이로부터 예상되는 라이프스타일 가설을 세웁니다.

2.  **속성 선택 및 다양성 고려**:
    * **연관성**: 핵심 인사이트와 위에서 설정한 라이프스타일 가설에 가장 잘 부합하는 속성들을 우선적으로 고려합니다.
    * **값 범위 활용 및 유연성**: 각 속성에 대해 제공된 '### 값 범위 및 카테고리 ###' 내에서 선택하되, 단순히 메타데이터에서 가장 높은 비율의 값만 선택하는 것을 넘어, 페르소나의 다른 특성과 **논리적으로 일관되면서도 현실적인 다양성**을 부여할 수 있는 값을 고려합니다.
        * 예를 들어, '지역'이나 '직업'과 같이 여러 비율이 유사한 경우, 페르소나의 전반적인 스토리에 더 적합하거나 미묘한 차이를 줄 수 있는 선택지를 반영하여 지나친 획일화를 피합니다.
    * **수치형 값의 현실성**: '1회평균식료품구입금액'과 같은 정수 값은 '가구소득'과 '가구원수'를 고려하여 **합리적이고 유동적인** 값을 부여합니다. (예: '중간소득-1인 가구'라도 구매 습관에 따라 금액이 달라질 수 있음을 반영)
    * **조건부 속성**: 'keyword'에 따라 '우유구입기준' 또는 '가공식품구입빈도/기준'과 같은 조건부 속성을 채웁니다.
        - 키워드가 "그릭요거트", "편의점커피라떼"인 경우:
            → "우유구입기준"만 포함하고, "가공식품구입빈도", "가공식품구입기준"은 포함하지 말라.
        - 제품키가 "스팸", "참치캔"인 경우:
            → "가공식품구입빈도", "가공식품구입기준"만 포함하고, "우유구입기준"은 포함하지 말라.
        - 제품키가 "참치액"인 경우:
            → "우유구입기준", "가공식품구입빈도", "가공식품구입기준"을 모두 포함하지 말라. (응답에 존재하면 안 됨)

※ 위 **조건부 필드 이외의 필드**는 빈 값 없이 채운다. **허용되지 않은 조건부 필드는 생성하지 말라**.



3.  **일관성 검토 및 최종 'reasoning' 작성**:
    * 선택된 모든 속성들이 서로 모순되지 않고, 페르소나가 하나의 일관된 인물로 느껴지도록 최종 검토합니다.
    * 이러한 사고 과정을 바탕으로 'reasoning' 필드에 페르소나 생성에 대한 논리적 근거를 한 단락으로 간결하게 요약하여 설명합니다.



### 값 범위 및 카테고리 ###

지역 : ['서울특별시', '부산광역시', '인천광역시', '대구광역시', '대전광역시', '광주광역시', '울산광역시', '경기도', '경상북도', '경상남도', '전라북도', '전라남도', '충청북도', '충청남도', '강원도', '제주도', '세종특별자치시']
교육수준 : ['대졸(전문대졸/대학원생 포함)', '고졸(대학생 포함)', '중졸 이하(초/중/고등학생 포함)', '미취학', '대학원졸']
직업 : ['사무 종사자', '주부', '판매 종사자', '기능원 및 관련 기능 종사자', '대학생/대학원생(휴학생 포함)', '서비스 종사자', '무직(초등학교 입학 전 영유아, 재수생 포함)', '장치, 기계 조작 및 조립 종사자', '단순노무 종사자', '관리자', '전문가 및 관련 종사자', '농림어업 숙련 종사자', '기타', '군인']
건강관심도 : ['매우 그렇다', '그런 편이다', '보통이다', '그렇지 않은 편이다', '전혀 그렇지 않다']
가구요리빈도 : ['자주', '보통', '거의 안함']
주거형태 : ['아파트', '단독주택', '연립/다세대주택', '기타']
건강투자정도 : ['매우 그렇다', '그런 편이다', '보통이다', '그렇지 않은 편이다', '전혀 그렇지 않다']
운동여부 : ['예', '아니오']
sns사용빈도 : ['자주 사용한다', '가끔 사용한다', '전혀 사용하지 않는다']
식료품구입빈도 : ['매일 1회 이상', '주 4~6회', '주 2~3회', '주 1회', '2주일에 1회', '1달에 1회', '그보다 드물게']
1회평균식료품구입금액: (숫자만, 정수)
우유구입기준 : ['안전성', '맛', '구입의 편리성', '조리의 편리성', '품질', '영양(건강)', '가격']
가공식품구입빈도 : ['매일', '주 4~6회', '주 2~3회', '주 1회', '2주일에 1회', '1달에 1회', '그보다 드물게']
가공식품구입기준 : ['품질', '구입의 편리성', '조리의 편리성', '맛', '신선도(제조일자, 유통기한 포함)', '영양(건강)', '안전성', '가격']

### 세그먼트 데이터 ###
{all_segment_data}

### JSON 스키마 ###
{schema}

출력은 반드시 JSON만 반환하세요. 다른 설명, 텍스트, 코드블럭은 포함하지 마세요.

### PERSONA GENERATION ###
"""
